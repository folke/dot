# - import_tasks: repos.yml
- name: Create the `aur_builder` user
  become: true
  ansible.builtin.user:
    name: aur_builder
    create_home: yes
    group: wheel

- name: Allow the `aur_builder` user to run `sudo pacman` without a password
  become: true
  ansible.builtin.lineinfile:
    path: /etc/sudoers.d/11-install-aur_builder
    line: "aur_builder ALL=(ALL) NOPASSWD: /usr/bin/pacman"
    create: yes
    mode: 0440
    validate: "visudo -cf %s"

- name: Ensure paru is installed
  become: true
  ansible.builtin.package:
    name: paru
    state: present

- name: Install packages (pacman)
  become: true
  become_user: aur_builder
  become_method: sudo
  aur:
    state: present
    use: paru
    name:
      # system
      - keyd
      - cachyos-snapper-support
      - cups
      - howdy-git
      - polkit-gnome
      - topgrade
      - xdg-desktop-portal-gnome
      - xdg-desktop-portal-hyprland
      - aria2

      # audio
      - easyeffects
      - lsp-plugins-lv2
      - zam-plugins
      - calf
      - mda.lv2
      - easyeffects-bundy01-presets
      # - jamesdsp

      # ui
      - brightnessctl
      - hyprland
      - hypridle
      - hyprland
      - hyprlock
      - hyprpaper
      - hyprpicker
      - hyprpolkitagent
      - hyprsunset
      - pavucontrol
      - rofi-wayland

      # niri
      - niri
      - mate-polkit
      - dms-shell-git

      # cli
      - atuin
      - bat
      - bob
      - btop
      - chafa
      - cliphist
      - duf
      - fd
      - fzf
      - grc
      - gum
      - htop
      - hyperfine
      - numbat-bin
      - ripgrep
      - starship
      - tealdeer
      - zoxide
      - mdcat
      - eza
      - ncdu
      - procs
      - dust
      - ranger
      - tokei
      - lazyjournal

      # dev
      - fnm-bin
      - git
      - git-delta
      - github-cli
      - httpie
      - jq
      - hub
      - just
      - lazygit
      - lazydocker
      - mermaid-cli
      - mutagen.io-bin
      - neovim
      - rustup
      - tectonic
      - wezterm
      - aspell
      - pnpm

      # apps
      - alacritty
      - kitty
      - ghostty
      - brave-bin
      - btrfs-assistant
      - rog-control-center
      - zen-browser-bin
      - discord
      - slurp
      - grim
      - grimblast-git
      - wev
      - imv
      - blueman

      # fonts
      - ttf-dejavu
      - ttf-fira-code
      - ttf-firacode-nerd
      - maplemono-ttf
      - maplemono-nf
      - ttf-ms-fonts
      - ttf-nerd-fonts-symbols
      - ttf-nerd-fonts-symbols-mono
      - ttf-opensans
      - ttf-victor-mono
      - ttf-victor-mono-nerd
